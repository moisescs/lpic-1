## 101.3 - Change runlevels / boot targets and shutdown or reboot system
Weight: 3

### Runlevel

* Cada runlevel é um conjunto de scripts que inicializam ou param processos, ficam armazenados em `/etc/rc[0-6].d`.
* Cada script inicia o nome com a letra **K** (kill) ou **S** (start).

Níveis são:
* 0 - shutdown
* 1 - modo de recuperação ou usuário único
* 2 - multiusuário sem rede
* 3 - multiusuário
* 5 - multiusuário com modo gráfico

```shell
# identifica o runlevel corrente
runlevel

# define um runlevel
init 1
telinit 3
```

### /etc/inittab

Em distribuições mais antigas com o SysVinit o arquivo onde define o runlevel padrão é o `/etc/inittab`.

```
# 3 - multiusuário é o valor padrão
id:3:initdefault
```

### Systemd

Em distribuições mais novas, não existe o arquivo `/etc/inittab`.
O runlevel é definido pela linha de comando ou manualmente no diretório: `/lib/systemd/system/default.target`.

```shell
# obtém o target padrão
systemctl get-default

# altera o runlevel padrão
systemctl set-default multi-user.target

# altera o runlevel padrão de forma manual para rescue ou 1 (usuário único ou recuperação)
ln -fs /lib/systemd/system/default.target /lib/systemd/system/default.target/rescue.target

# altera o runlevel corrente para outro
systemctl isolate runlevel6.target

# altera o runlevel corrente para outro
systemctl [rescue, poweroff, emergency,...]

# verifica se uma unidade está habilitada
systemctl is-enabled nginx.service

# lista as unidades do tipo service
systemctl list-unit-files -t service

# habilita ou desabilita o serviço nginx
systemctl enable/disable nginx.service

# inicia, para ou recarrega os arquivos de configuração do serviço nginx
systemctl start/stop/restart/reload nginx.service
```

O `systemd` identifica os recursos que gerencia como unidades divididas em: `service`, `socket`, `device`, `mount`, `automount`, `target`, `snapshot`.
