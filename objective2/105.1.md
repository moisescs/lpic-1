## 105.1 Customize and use the shell environment

* Set environment variables (e.g. PATH) at login or when spawning a new shell.
* Write Bash functions for frequently used sequences of commands.
* Maintain skeleton directories for new user accounts.
* Set command search path with the proper directory.

### .
### source

Lê e executa o arquivo. O arquivo não precisa de permissão de execução, bastando `0400`.

```shell
# arquivo teste: function teste() { date +%s -d yesterday }
source teste
teste
```

### exec

Executa o script e sai no final com `exit`.

### /etc/bash.bashrc
--norc ignora o .bashrc global ou  local
### /etc/profile
### env

```shell
# ignora uma variável
env -u NOME
env --unset=NOME

# ignora todas variáveis
env -i

# retira a quebra de linha
env -0
```

### export
### set
### unset
### ~/.bash_profile

Primeiro arquivo a ser executado quando ocorre login. Caso existe, os outros serão ignorados.

### ~/.bash_login

É executado caso não exista `.bash_profile`.

### ~/.profile

É executado caso não exista `.bash_profile` nem `.bash_login`.

### ~/.bashrc
### ~/.bash_logout /etc/bash.bash_logout

Pode ser definido especificamente para o usuário ou de forma global.

### function
### alias

```shell
# cria um alias
alias la='ls -a'

# remove o alias
unalias la
```

### shellscript

* `#!/usr/bin/env bash` determina a localização do interpretador automativamente, para os casos de portabilidade.

#### controle

* `||` executa em caso de falha.
* `&&` executa em caso de sucesso.

#### parâmetros

* `$n` `n > 0`, parâmetros do comando.

#### testes

**arquivos**
* `-e` verifica se o arquivo existe, `test -e /dev/zero` retorna `true`.
* `-f` verifica se o arquivo existe e é normal. `test -f /dev/zero` retorna `false`.
* `-r` verifica se o arquivo existe e o usuário tem permissão de leitura.

**números**
* `-lt`
* `-gt`
* `-eq`
* `-lte`
* `-gte`

#### variáveis

* `${VAR1}` melhor maneira para garantiar que uma variável seja interpretada corretamente.

**arrays**
```shell
# definição de arrays
NAMES=(thiago graciane)

NUMBERS[0]=20
NUMBERS[1]=23
NUMBERS[2]=27

# acesso
echo ${NAMES[1]} ${NUMBERS[2]}
```

**atribuir comandos**
```shell
TIMESTAMP=$(date +%s)
TIMESTAMP=`date +%s`
```

**opções**

```shell
# declara como somente leitura
declare -r pi=3.14

# exporta a variável
declare -x SUPERPATH=/super/path

# exibe os atributos e valore de cada NAME
declare -p PS1
```

#### condicional

**if**
```shell
if [ -d ~/.ssh ]; then
    echo ssh dir
elif [ -f ~/.profile ]; then
    echo profile
else
    echo $HOME
fi
```

**case**

#### repetição

**for**
**while**
**until**

#### funções

```shell
function x() {
    echo Função x
}
```
### Pré-definidas

* HOME
* TMOUT log inatividade
* PS1 normalmente definida em /etc/profile é usada para customizar o shell prompt, incluindo hostname, diretório corrente (working directory) e outros elementos.

### outros

* `readonly` shell builtin usado para exibir as variáveis declaradas como readonly.
* `read var` é utilizado para fazer a leitura de uma variável. `-p` não quebra a linha; `s` não exibe a entrada.
